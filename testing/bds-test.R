require(tseries)

frame_files <- lapply(sys.frames(), function(x) x$ofile)
frame_files <- Filter(Negate(is.null), frame_files)
setwd(dirname(frame_files[[length(frame_files)]]))

df <- read.csv("data/pv.csv", header = T)

bds.test(df$pv, m = 10)
# 
# 	 BDS Test
#
# data:  df$pv
#
# Embedding dimension =   2  3  4  5  6  7  8  9 10
#
# Epsilon for close points =   94.7925 189.5851 284.3776 379.1701
#
# Standard Normal =
#        [ 94.7925 ] [ 189.5851 ] [ 284.3776 ] [ 379.1701 ]
# [ 2 ]      26.2488      16.9095      12.0554      13.3231
# [ 3 ]      34.7476      19.2542      11.0756      11.6600
# [ 4 ]      46.0679      21.2769      11.3600      10.4822
# [ 5 ]      70.4751      27.1976      12.1520       9.5538
# [ 6 ]     124.7066      39.9101      12.2764       8.7043
# [ 7 ]     218.3399      56.0526      14.2528       8.8265
# [ 8 ]     408.5722      83.9699      19.0836       9.7265
# [ 9 ]     773.5772     123.9684      24.1734      10.4397
# [ 10 ]   1465.8982     183.4653      30.1376      10.9997
#
# p-value =
#        [ 94.7925 ] [ 189.5851 ] [ 284.3776 ] [ 379.1701 ]
# [ 2 ]            0            0            0            0
# [ 3 ]            0            0            0            0
# [ 4 ]            0            0            0            0
# [ 5 ]            0            0            0            0
# [ 6 ]            0            0            0            0
# [ 7 ]            0            0            0            0
# [ 8 ]            0            0            0            0
# [ 9 ]            0            0            0            0
# [ 10 ]           0            0            0            0

set.seed(123)
rnd <- rnorm(1000, 0, 1)
bds.test(rnd, m = 10)
#
# 	 BDS Test
#
# data:  rnd
#
# Embedding dimension =   2  3  4  5  6  7  8  9 10
#
# Epsilon for close points =  0.4958 0.9917 1.4875 1.9834
#
# Standard Normal =
#        [ 0.4958 ] [ 0.9917 ] [ 1.4875 ] [ 1.9834 ]
# [ 2 ]     -0.2093    -0.8773    -0.5987    -0.4051
# [ 3 ]     -0.4777    -1.2593    -0.8352    -0.7121
# [ 4 ]     -0.6752    -1.0543    -0.5397    -0.5165
# [ 5 ]     -1.1127    -1.3509    -0.7835    -0.8297
# [ 6 ]      0.4928    -1.5359    -1.0823    -1.1382
# [ 7 ]      0.6879    -1.6424    -1.3213    -1.3235
# [ 8 ]     -0.3658    -1.8280    -1.5801    -1.5340
# [ 9 ]      3.1748    -2.0609    -1.7665    -1.7532
# [ 10 ]     2.8868    -2.2599    -1.9084    -1.9465
#
# p-value =
#        [ 0.4958 ] [ 0.9917 ] [ 1.4875 ] [ 1.9834 ]
# [ 2 ]      0.8342     0.3803     0.5494     0.6854
# [ 3 ]      0.6328     0.2079     0.4036     0.4764
# [ 4 ]      0.4996     0.2917     0.5894     0.6055
# [ 5 ]      0.2658     0.1767     0.4333     0.4067
# [ 6 ]      0.6222     0.1246     0.2791     0.2550
# [ 7 ]      0.4915     0.1005     0.1864     0.1857
# [ 8 ]      0.7146     0.0676     0.1141     0.1250
# [ 9 ]      0.0015     0.0393     0.0773     0.0796
# [ 10 ]     0.0039     0.0238     0.0563     0.0516
